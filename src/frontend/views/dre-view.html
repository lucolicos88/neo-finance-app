<div class="view-container" id="dre-view">
  <h1 class="view-title">DRE Gerencial - Demonstra√ß√£o do Resultado do Exerc√≠cio</h1>

  <!-- Filtros -->
  <div class="card">
    <div class="filters">
      <div class="d-flex justify-between align-center mb-2">
        <h3 class="filters-title">Selecionar Per√≠odo</h3>
        <button class="btn btn-outline" onclick="voltarRelatorios()">‚Üê Voltar</button>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label class="form-label">M√™s</label>
          <select class="form-control" id="dre-mes">
            <option value="1">Janeiro</option>
            <option value="2">Fevereiro</option>
            <option value="3">Mar√ßo</option>
            <option value="4">Abril</option>
            <option value="5">Maio</option>
            <option value="6">Junho</option>
            <option value="7">Julho</option>
            <option value="8">Agosto</option>
            <option value="9">Setembro</option>
            <option value="10">Outubro</option>
            <option value="11">Novembro</option>
            <option value="12">Dezembro</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Ano</label>
          <select class="form-control" id="dre-ano">
            <option value="2024">2024</option>
            <option value="2025" selected>2025</option>
            <option value="2026">2026</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Filial</label>
          <select class="form-control" id="dre-filial">
            <option value="">Consolidado</option>
          </select>
        </div>

        <div class="form-group" style="display: flex; align-items: flex-end;">
          <button class="btn btn-primary" onclick="carregarDRE()" style="width: 100%;">
            üîç Gerar DRE
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- KPIs -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">Receita L√≠quida</div>
      <div class="stat-value" id="dre-receita-liquida">R$ 0,00</div>
      <div class="stat-change" id="dre-receita-transacoes">0 transa√ß√µes</div>
    </div>

    <div class="stat-card success">
      <div class="stat-label">Margem Bruta</div>
      <div class="stat-value" id="dre-margem-bruta">R$ 0,00</div>
      <div class="stat-change" id="dre-margem-bruta-perc">0%</div>
    </div>

    <div class="stat-card">
      <div class="stat-label">EBITDA</div>
      <div class="stat-value" id="dre-ebitda">R$ 0,00</div>
      <div class="stat-change" id="dre-ebitda-perc">0%</div>
    </div>

    <div class="stat-card" id="dre-lucro-card">
      <div class="stat-label">Lucro L√≠quido</div>
      <div class="stat-value" id="dre-lucro-liquido">R$ 0,00</div>
      <div class="stat-change" id="dre-lucro-perc">0%</div>
    </div>
  </div>

  <!-- DRE Table -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title" id="dre-titulo">DRE - Aguardando sele√ß√£o</h2>
      <div class="card-actions">
        <button class="btn btn-outline" onclick="exportarDRE()">
          üì• Exportar PDF
        </button>
      </div>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th style="width: 50%;">Descri√ß√£o</th>
            <th style="width: 20%; text-align: right;">Valor</th>
            <th style="width: 15%; text-align: right;">% Receita</th>
            <th style="width: 15%; text-align: center;">Classifica√ß√£o</th>
          </tr>
        </thead>
        <tbody id="table-dre">
          <tr>
            <td colspan="4" class="text-center text-muted">Selecione um per√≠odo e clique em "Gerar DRE"</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- An√°lise por Categoria -->
  <div class="card">
    <div class="card-header">
      <h2 class="card-title">Despesas Operacionais por Categoria</h2>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Categoria</th>
            <th style="text-align: right;">Valor</th>
            <th style="text-align: right;">% da Receita</th>
          </tr>
        </thead>
        <tbody id="table-desp-categorias">
          <tr>
            <td colspan="3" class="text-center text-muted">Aguardando dados</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script>
// Inicializar m√™s atual
document.addEventListener('DOMContentLoaded', function() {
  const hoje = new Date();
  const mesAtual = hoje.getMonth() + 1;
  const anoAtual = hoje.getFullYear();

  const selectMes = document.getElementById('dre-mes');
  const selectAno = document.getElementById('dre-ano');

  if (selectMes) selectMes.value = mesAtual;
  if (selectAno) selectAno.value = anoAtual;
});

function voltarRelatorios() {
  navigateTo('relatorios');
}

function exportarDRE() {
  showToast('Exporta√ß√£o em desenvolvimento', 'info');
}
</script>
